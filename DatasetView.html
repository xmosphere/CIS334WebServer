<html>
    <head>
        <link rel="stylesheet" href="styles/divDataset.css">
        <link rel="stylesheet" href="styles/styles.css">
        <script type="module" src="node_modules/xlsx/xlsx.mjs">
            import { read, writeFileXLSX } from "xlsx";

            /* load the codepage support library for extended support with older formats  */
            import { set_cptable } from "xlsx";
            import * as cptable from 'xlsx/dist/cpexcel.full.mjs';
            set_cptable(cptable);
        </script>
        <title></title>
    </head>
    <body>
        <div id="headerDiv">
            <h1>Data Graphing Tool</h1>
            <h3><a href="index.html">Home</a> |
                 <a href="DatasetView.html">Data View</a> |
                  <a href="GraphView.html">Graph View</a></h3>
        </div>
        <div id="datasetList">
            <h2>Test</h2>
            <select id="datasetListBox" size="5">
            </select>
        </div>
        <div id="tableView">
            <form>
            <table id="DatasetEditor">
                <tr>
                    <td>
                        <p>Dataset Name</p>
                    </td>
                    <td>
                        <input type="text" id="DatasetName">
                    </td>
                </tr>
                <tr>
                    <td> <input type="file" name="" id="fileIn"> </td>
                    <td>
                        <input type="button" value="Save" id="saveDatasetBtn" onclick="addDataset()">
                        <input type="button" value="Delete" id="clearDatasetBtn" onclick="clearForm()">
                    </td>
                </tr>
            </table>
            <div id="tableObject"></div>
        </form>
        </div>
        <div id="columnView">
            <div id="columnViewHeader">
                <p>Column Name</p>
            </div>
            <div id="columnViewDatasets">
                <p>Datasets</p>
                <select id="datasetSelectBox" size="5">
                </select>
                <input type="button" value="Select">
            </div>
            <div id="columnViewColumns">
                <p>Columns</p>
                <select id="columnBox" size="5">
                </select>
                <input type="button" value="Select">
            </div>
        </div>
        <script>
            var wb = xlsx.readFile('files/File1.xlsx');
            var ws = wb.Sheets("Sheet1");

            console.log(ws)
            var datasets = [];
            var datasetListSelect = document.getElementById("datasetListBox");
            var datasetSelectBox = document.getElementById("datasetSelectBox")
            var count = 0;
            function addDataset() {
                let dataset = {
                    id: count,
                    datasetName: document.getElementById("DatasetName").value,
                    filePath: document.getElementById('fileIn').value
                }
                datasets.push(dataset);
                localStorage.setItem('datasetFilePaths', JSON.stringify(datasets));
                document.forms[0].reset();
                var option = document.createElement("option")
                option.text = dataset.datasetName;
                datasetListSelect.add(option, count);
                datasetSelectBox.add(option, count);
                count =+ 1;
            }
            function clearForm() {
                document.forms[0].reset();
                count = 0
            }
        </script>
    </body>
</html>